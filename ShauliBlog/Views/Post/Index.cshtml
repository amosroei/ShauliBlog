@model IEnumerable<ShauliBlog.Models.Post>

@{
    ViewBag.Title = "Search";
    ViewBag.ShowFilter = true;
    
    //Layout = "~/Views/Shared/_Layout.cshtml";
}

@using (Html.BeginForm())
{
    <h4>
        Find By Title:
    </h4>
    @Html.TextBox("SearchTitle")

    <h4>
        Find By Author:
    </h4>
    @Html.TextBox("SearchAuthor")
    <input type="submit" value="Search" />
}

<script src="~/Scripts/jquery-1.7.1.min.js" type="text/javascript"></script>
<script src="~/Scripts/PostScript.js" type="text/javascript"></script>

@if (Model.Count() != 0)
{
    int i = 0;

    <div class="PostDiv">          
        @foreach (var post in Model)
        {
            i++;
            
            <section class="panel panel-primary PostSection">

                @*@if (user != null && ((post.OwnerUser != null && user.Id == post.OwnerUser.Id) || user.IsAdmin))
                    {*@
                <div class="panel-heading">
                    <a href="~/Post/Delete/@post.PostID">
                        <img src="~/images/x.png" class="postHeaderImg" />
                    </a>

                    <a href="~/Post/Edit/@post.PostID">
                        <img src="~/images/edit.gif" class="postHeaderImg editPostImg" />
                    </a>
               
                    <p class="PostTitle">
                        @post.PostTitle - <span style="font-size:15px;">@post.PostDate</span> - <a style="color:white;" href="http://@post.PostAuthorWebsite">@post.PostAuthor</a>
                    </p>                    
                </div>
                <div class="panel-body">
                    <label>@post.PostVideoPath</label>
                    <video controls="controls">
                        <source src="~/videos/@post.PostVideoPath" type="video/mp4" />
                        Your browser does not support the video tag.
                    </video>

                    <label>@post.PostPicturePath</label>
                    <img src="~/images/@post.PostPicturePath" style="width:100%" />

                    <p class="PostDesc">
                        @post.PostText
                    </p>

                    <div class="ShowCommentbtnDiv">
                        <button id="ShowCommentBtn_@post.PostID" onClick="ShowCommentBtnClick('ShowCommentBtn_@post.PostID')" class="ShowCommentBtn HideBackground"></button>
                        <span>Comments</span>
                    </div>

                    <div id="CommentsDiv_@post.PostID" class="CommentsDiv collapse">
                        <section class="CommentSection">
                            <div id="NewComment_@post.PostID" class="NewComment">

                                <input class="CommentAuthor" type="text" placeholder="Name" />

                                <textarea class="CommentText" placeholder="Write your comment here..." rows="3" maxlength="255"></textarea>

                                <input type="button" value="Post" onClick="NewComment(@post.PostID)" />

                            </div>

                            <div class="CommentsList">
                                @foreach (var comment in post.PostComments.OrderByDescending(c => c.CommentID))
                                {
                            <p id="Comment_@comment.">
                                @*@if (user != null && ((comment.User != null && user.Id == comment.User.Id) || user.IsAdmin))
                        {*@
                                <a onclick="DeleteComment(@comment.CommentID)" style="cursor:pointer;">
                                    <img src="~/images/x.png" class="postHeaderImg" />
                                </a>
                                @*  }*@
                                @*<b>@string.Format("{0} - {1}", comment.CommentID, comment.User != null ? comment.User.Username : comment.Name)</b>*@
                                author : @comment.CommentAuthor
                                <b>@string.Format("{0} - {1}", comment.CommentID, comment.CommentAuthor)</b>
                                <br>
                                @comment.CommentText
                            </p>

                                }
                            </div>
                        </section>
                    </div>
                </div>
            </section>

        }
    </div>
}
else
{
    ViewBag.EmptyPosts = true;
}

<p>
    @Html.ActionLink("Add New Post", "Create")
</p>
